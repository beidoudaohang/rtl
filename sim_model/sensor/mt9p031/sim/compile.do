
##	===============================================================================================
##	ref ***准备工作***
##	===============================================================================================
##	-------------------------------------------------------------------------------------
##	首先先把define.do 跑一遍，防止修改了define之后，造成错误
##	-------------------------------------------------------------------------------------
do define.do
echo	"compile start ******"

##	-------------------------------------------------------------------------------------
##	如果定义了后仿真，首先把netgen目录下清空，然后再把工程目录下的netgen目录复制过来
##	-------------------------------------------------------------------------------------
if {$SIM_MODE == "back" } {
	file delete -force netgen
	file copy ../prj/netgen	../sim
}

##	-------------------------------------------------------------------------------------
##	常用的compile的语法
##	1.+incdir+ 包含头文件的路径
##	2.+define+MACRO[=NAME]	宏定义
##	-------------------------------------------------------------------------------------
#vlog	$env(XILINX)/verilog/src/glbl.v
#vlog	../testbench/tb_bram.v
#vlog	+incdir+../src	+incdir+../testbench	+define+SIMULATION	../src/*.v
#vlog	+incdir+../testbench +define+x1Gb +define+sg187E +define+x16 ../testbench/ddr3_model_c3.v

##	-------------------------------------------------------------------------------------
##	根据参数，决定要编译哪些源文件
##	-------------------------------------------------------------------------------------
set	mt9p031		0

if {$TB_MODULE == "mt9p031" } {
	set	mt9p031		1
} elseif {$TB_MODULE == "" } {

}


##	===============================================================================================
##	ref ***开始编译***
##	===============================================================================================
##	-------------------------------------------------------------------------------------
##	xilinx的很多ip需要glbl文件才能仿真
##	-------------------------------------------------------------------------------------
vlog	$env(XILINX)/verilog/src/glbl.v

##	-------------------------------------------------------------------------------------
##	根据不同的DUT，compile不同的文件
##	-------------------------------------------------------------------------------------
##	-------------------------------------------------------------------------------------
##	ref 1.编译源代码
##	-------------------------------------------------------------------------------------
##	-------------------------------------------------------------------------------------
##	sync_bufferr 模块
##	-------------------------------------------------------------------------------------
if { $mt9p031 == 1 } {
	vlog	+define+TESTCASE=$TESTCASE	../src/*.v
}

##	-------------------------------------------------------------------------------------
##	ref 2.编译仿真模型
##	-------------------------------------------------------------------------------------


##	-------------------------------------------------------------------------------------
##	global 仿真模型
##	-------------------------------------------------------------------------------------


##	-------------------------------------------------------------------------------------
##	ref 3.编译测试代码
##	-------------------------------------------------------------------------------------
vlog	+define+TESTCASE=$TESTCASE	../testbench/tb_$TB_MODULE/*.v
